# Survey Data Setup & Management

This document explains how the survey data system works in the Leadership Launchpad.

## Overview

The Leadership Launchpad uses **three survey data files** with a clear separation between input files (manually managed) and output files (automatically generated).

### File Structure

#### INPUT FILES (Manually Updated)
These files contain raw survey responses and should be manually updated when new survey data is collected:

- **`surveyData.json`** = Post Academy Training Survey (Survey ONE)
  - Contains responses from leaders after completing Academy training
  - Updated manually when new Post Academy survey responses are received

- **`surveyData1.json`** = Listening Session Survey (Survey TWO)
  - Contains responses from listening sessions with leaders
  - Updated manually when new Listening Session survey responses are received

> ⚠️ **IMPORTANT**: Never overwrite or delete these input files. They are your source of truth for survey data.

#### OUTPUT FILE (Automatically Generated)
This file is automatically created by combining the two input files:

- **`combinedSurveyData.json`** = Combined Survey Data
  - Automatically generated by adding all numeric values from both input files
  - Used by the charts on the People Partner Portal
  - Do not manually edit this file - it will be overwritten

## How It Works

### Automated Workflow

1. **User Updates Source Data**
   - Update `surveyData.json` with new Post Academy Training responses
   - AND/OR update `surveyData1.json` with new Listening Session responses

2. **Push Changes to GitHub**
   - Commit and push your changes to the `main` branch

3. **Automatic Combination**
   - GitHub Actions workflow automatically runs
   - Reads both `surveyData.json` and `surveyData1.json`
   - Combines all numeric values by adding them together
   - Creates/updates `combinedSurveyData.json`
   - Commits the updated combined file back to the repository

4. **Charts Update Automatically**
   - The People Partner Portal fetches data from `combinedSurveyData.json`
   - Charts automatically display the combined results

### Manual Combination (Local Development)

You can also run the combination script manually on your local machine:

```bash
npm run combine-surveys
```

Or directly with Node.js:

```bash
node scripts/fetchSurveyData.js
```

## Data Structure

All three files share the same JSON structure:

```json
{
  "trainingAttended": {
    "newLeaders": 0,
    "leadingIndividualContributors": 0,
    "leadingLeaders": 0
  },
  "effectiveness": {
    "veryEffective": 0,
    "somewhatEffective": 0,
    "neutral": 0,
    "somewhatIneffective": 0,
    "neitherEffectiveNorIneffective": 0
  },
  "trainingNeeds": {
    "communication": 0,
    "decisionMaking": 0,
    "teamBuilding": 0,
    "conflictResolution": 0,
    "strategicThinking": 0,
    "other": 0
  }
}
```

## How Data is Combined

The combination script adds all numeric values from both input files:

**Example:**

If `surveyData.json` has:
```json
{ "trainingAttended": { "newLeaders": 3 } }
```

And `surveyData1.json` has:
```json
{ "trainingAttended": { "newLeaders": 5 } }
```

Then `combinedSurveyData.json` will have:
```json
{ "trainingAttended": { "newLeaders": 8 } }
```

## Workflow Details

The GitHub Actions workflow (`.github/workflows/update-survey-data.yml`):

- **Triggers on**:
  - Push to `main` branch when `surveyData.json` or `surveyData1.json` changes
  - Manual trigger via workflow dispatch

- **Actions**:
  1. Checks out the repository
  2. Sets up Node.js
  3. Runs the combination script
  4. Commits only `combinedSurveyData.json` if it changed
  5. Pushes the update back to the repository

## Best Practices

1. ✅ **Always update source files** (`surveyData.json` and `surveyData1.json`) with new survey responses
2. ✅ **Commit both source files** when you have new data from both surveys
3. ✅ **Let the workflow handle** the combination - don't manually edit `combinedSurveyData.json`
4. ✅ **Track all three files** in git (don't add them to `.gitignore`)
5. ❌ **Never delete** or overwrite the input files
6. ❌ **Never manually edit** `combinedSurveyData.json`

## Troubleshooting

### Workflow Not Running?
- Check that you pushed to the `main` branch
- Verify that `surveyData.json` or `surveyData1.json` was actually changed
- Check the Actions tab in GitHub for workflow status

### Charts Not Updating?
- Verify `combinedSurveyData.json` was updated in the repository
- Clear browser cache and refresh the portal page
- Check browser console for any fetch errors

### Want to Test Locally?
```bash
# Install Node.js if not already installed
# Then run:
npm run combine-surveys

# Check the generated file:
cat combinedSurveyData.json
```

## Support

For questions or issues with the survey data system, please contact the repository maintainers.
